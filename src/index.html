<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Move Minder</title>

    <link rel="stylesheet" href="css/index.css"/>

    <script src="js/app.js" defer></script>
</head>
<body>
<div style="color: #206f01;width: 90%;background: #d3f0d3;padding: 5px;border-radius: 3px;margin: 10px auto 0;text-align: center;" id="holiday-text">
    <span> Next holiday: </span> <span>Date, Month, Day, "Holiday"</span>
</div>
<div id="toggle-file-shortcut" style="width: 50px; height: 50px; background: radial-gradient(white, green 50%); position: absolute; bottom: 35px;border: 3px solid green; cursor: pointer; border-radius: 50%">
    <svg width="35px" height="35px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;
    top: 6px;
    left: 7px;">

        <g id="SVGRepo_bgCarrier" stroke-width="0"/>

        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>

        <g id="SVGRepo_iconCarrier"> <path d="M10 14H12M12 14H14M12 14V16M12 14V12" stroke="green" stroke-width="1.5" stroke-linecap="round"/> <path d="M22 11.7979C22 9.16554 22 7.84935 21.2305 6.99383C21.1598 6.91514 21.0849 6.84024 21.0062 6.76946C20.1506 6 18.8345 6 16.2021 6H15.8284C14.6747 6 14.0979 6 13.5604 5.84678C13.2651 5.7626 12.9804 5.64471 12.7121 5.49543C12.2237 5.22367 11.8158 4.81578 11 4L10.4497 3.44975C10.1763 3.17633 10.0396 3.03961 9.89594 2.92051C9.27652 2.40704 8.51665 2.09229 7.71557 2.01738C7.52976 2 7.33642 2 6.94975 2C6.06722 2 5.62595 2 5.25839 2.06935C3.64031 2.37464 2.37464 3.64031 2.06935 5.25839C2 5.62595 2 6.06722 2 6.94975M21.9913 16C21.9554 18.4796 21.7715 19.8853 20.8284 20.8284C19.6569 22 17.7712 22 14 22H10C6.22876 22 4.34315 22 3.17157 20.8284C2 19.6569 2 17.7712 2 14V11" stroke="white" stroke-width="1.5" stroke-linecap="round"/> </g>

    </svg>
</div>

<div id="main-ui">
    <div style="display: flex; justify-content: space-between">
        <h1 class="green" id="app-title">üíñ My Work Station!</h1>
        <h1 style="color: green"> ‚è±Ô∏è <span id="demo">30m 00s</span></h1>
    </div>


    <div style="display: flex; justify-content: space-between;">

        <div style="width: 100%">

            <div id="nvm" style="display: none">
                <p class="green">Change node version.</p>

                <div style="zoom: .8">

                    <div id="node_list">

                    </div>

                </div>
            </div>

            <div id="quoteWrapper" style="display: none;height: 100%; width: 95%; position: relative;">
                <div style="height: 100%; width: 100%;
                    background: url('nature.jpg');
                    /*background: green;*/
                    background-repeat: no-repeat;
                    filter: blur(5px);
                    background-size: cover;
                    background-position: center;
                    box-sizing: border-box;
                    padding: 20px; border-radius: 10px;
                    ">

                </div>

                <div style="height: 100%; width: 100%; position: absolute; top: 0;
                box-sizing: border-box;
                    border-radius: 10px;
                    border: 3px solid #1c591c">

                </div>

                    <div id="quoteBox" style="position: absolute; top: 0; height: 100%; width: 100%; box-sizing: border-box; display: flex;
                    justify-content: center;
                    align-items: center;">
                        <div style="width: 5%; rotate: 180deg; cursor: pointer" id="prevQuote">
                            <svg fill="#000000" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 70 70" enable-background="new 0 0 70 70" xml:space="preserve">
                                <g id="SVGRepo_iconCarrier">
                                    <path d="M34.779,7c2.433,0,4.634,1.614,5.212,4.005l11.386,23.299h0.036l-0.019,0.066l0.019,0.066h-0.036L39.991,58.994 C39.413,61.385,37.211,63,34.777,63c-0.404,0-0.814-0.045-1.225-0.138c-2.882-0.654-4.671-3.441-3.998-6.23L40.332,34.37 L29.555,13.366c-0.673-2.787,1.116-5.576,3.998-6.229C33.963,7.044,34.375,7,34.779,7 M34.779,3c-0.708,0-1.419,0.079-2.11,0.236 c-2.476,0.561-4.565,2.042-5.888,4.171c-1.291,2.079-1.687,4.528-1.115,6.897c0.075,0.308,0.186,0.605,0.33,0.888l9.867,19.229 l-9.909,20.467c-0.124,0.258-0.221,0.527-0.288,0.805c-0.571,2.369-0.176,4.818,1.114,6.896c1.321,2.129,3.411,3.611,5.89,4.174 C33.361,66.92,34.07,67,34.777,67c4.199,0,7.832-2.705,8.985-6.631l11.036-23.803c0.437-0.694,0.647-1.502,0.609-2.313 c-0.013-0.711-0.219-1.411-0.594-2.025L43.75,9.585C42.581,5.684,38.962,3,34.779,3L34.779,3z"></path>
<!--                                    <path d="M22.588,31.325c2.209,0,4,1.791,4,4s-1.791,4-4,4s-4-1.791-4-4S20.379,31.325,22.588,31.325 M22.588,27.325 c-4.411,0-8,3.589-8,8s3.589,8,8,8s8-3.589,8-8S26.999,27.325,22.588,27.325L22.588,27.325z"></path>-->
                                </g>
                            </svg>
                        </div>
                        <div style="background: rgba(223,252,223,0.49);width: 88%;
                            padding: 10px; box-sizing: border-box;
                            border-radius: 5px;
                            filter: contrast(200%);
                            box-shadow: #057905 0 0 20px;"

                        >
                            ‚Äú<span class="quoteText" style="font-family: 'Inter Semi Bold'; ">You only live once, but if you do it right, once is enough.</span>‚Äù
                            <br>
                            ‚Äï
                            <span class="authorOrTitle" style="font-family: 'Ink Free'; font-weight: bolder; ">Mae West</span>
                        </div>
                        <div style="width: 5%;  cursor: pointer" id="nextQuote">
                            <svg fill="#000000" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 70 70" enable-background="new 0 0 70 70" xml:space="preserve">
                                <g id="SVGRepo_iconCarrier">
                                    <path d="M34.779,7c2.433,0,4.634,1.614,5.212,4.005l11.386,23.299h0.036l-0.019,0.066l0.019,0.066h-0.036L39.991,58.994 C39.413,61.385,37.211,63,34.777,63c-0.404,0-0.814-0.045-1.225-0.138c-2.882-0.654-4.671-3.441-3.998-6.23L40.332,34.37 L29.555,13.366c-0.673-2.787,1.116-5.576,3.998-6.229C33.963,7.044,34.375,7,34.779,7 M34.779,3c-0.708,0-1.419,0.079-2.11,0.236 c-2.476,0.561-4.565,2.042-5.888,4.171c-1.291,2.079-1.687,4.528-1.115,6.897c0.075,0.308,0.186,0.605,0.33,0.888l9.867,19.229 l-9.909,20.467c-0.124,0.258-0.221,0.527-0.288,0.805c-0.571,2.369-0.176,4.818,1.114,6.896c1.321,2.129,3.411,3.611,5.89,4.174 C33.361,66.92,34.07,67,34.777,67c4.199,0,7.832-2.705,8.985-6.631l11.036-23.803c0.437-0.694,0.647-1.502,0.609-2.313 c-0.013-0.711-0.219-1.411-0.594-2.025L43.75,9.585C42.581,5.684,38.962,3,34.779,3L34.779,3z"></path>
                                </g>
                            </svg>
                        </div>
                    </div>
            </div>



            <!--<div class="quoteText" style="display: flex; flex-direction: column; width: 90%; justify-content: center; height: 100%">
                ‚ÄúTwo roads diverged in a wood, and I‚ÄîI took the one less traveled by, And that has made all the difference.‚Äù
                <br>
                ‚Äï
                <span class="authorOrTitle">
                        Mae West
                    </span>
            </div>-->


        </div>

        <div style="display: flex; flex-direction: column; align-items: center">

            <div>
                <div style="width: 100%; display: flex; color: green; margin-bottom: 1rem">
                    <div class="time-modify-btn" id="time-decrease" style="border-radius: 30px 0 0 30px;"> -5 </div>
                    <div class="time-modify-btn" id="time-increase" style="border-radius: 0 30px 30px 0;"> +5 </div>
                </div>
                <!--<div style="zoom: .3; display: flex; justify-content: space-between">
                    <div class="fun-btn" style="background: #358535">
                        <div style="width: 4rem; font-size: 3rem; font-weight: bolder">
                            -5
                        </div>
                    </div>
                    <div class="fun-btn" style="background: green">
                        <div style="width: 4rem; font-size: 3rem; font-weight: bolder">
                            +5
                        </div>
                    </div>
                </div>-->

                <div id="focus-area" style="background-size: cover">
                    <circle-progress value="100" max="100" text-format="none" ></circle-progress>
                </div>
            </div>


            <div style="zoom: .4; display: flex">

                <div class="fun-btn" id="minimize-btn">
                    <div style="width: 4rem;">
                        <svg viewBox="202.637 140.287 70.144 68.347">
                            <rect x="218.226" y="170.866" width="39.568" height="15.392" style="fill: rgb(216, 216, 216); stroke: rgb(0, 0, 0);" rx="5.696" ry="5.696"></rect>
                        </svg>
                    </div>
                </div>

                <div class="bot√≥n" id="play">
                    <div class="fondo" x="0" y="0" width="200" height="200"></div>
                    <div class="icono" width="200" height="200">
                        <div class="parte izquierda" x="0" y="0" width="200" height="200" fill="#fff"></div>
                        <div class="parte derecha" x="0" y="0" width="200" height="200" fill="#fff"></div>
                    </div>
                    <div class="puntero"></div>
                </div>

                <div class="fun-btn" id="maximize-btn">
                    <div style="width: 3rem;">
                        <svg viewBox="156.475 163.07 129.496 126.498">
                            <rect x="181.354" y="168.465" width="100" height="100" stroke-width="5%" style="fill: rgb(255,255,255); stroke: green;" rx="25.18" ry="25.18" transform="matrix(0.9999989867210389, -0.0013380000600591302, 0, 1.0000009536743164, 1.4210854715202004e-14, 0.30955001711845753)"></rect>
                            <rect x="163.369" y="185.551" width="100" height="100" stroke-width="5%" style="fill: rgb(255,255,255); stroke: green;" rx="10.192" ry="10.192" transform="matrix(1, 0, 0, 1, 1.4210854715202004e-14, 3.552713678800501e-15)"></rect>
                        </svg>
                    </div>
                </div>

            </div>
        </div>

    </div>


    <div style="position: absolute; bottom: 0; width: 100%">
        <input type="file" id="quick-open" style="display:none;"/>
        <label for="quick-open">
            <div style="height: 5rem;
                        background: #f3f3f3;
                        border: 3px dashed #b9b9b9;
                        border-radius: 5px;
                        text-align: center;
                        color: #abd0c0;
                        cursor: pointer;
                        bottom: 1rem;
                        position: relative;
                "
                 id="drop-area"
            >
                <h4 style="
                    margin-bottom: 0;
                    margin-top: 15px;
                ">
                    Drag &amp; Drop here for shortcut! or
                </h4>
                <h3 style="
                    margin: 0;
                ">
                    Click me to choose file
                </h3>
            </div>
        </label>

        <div style="display: flex; justify-content: space-evenly;" id="btn-area">



            <div style="
        width: 4rem;
        cursor: pointer;
        color: #008cff;
        font-weight: bolder;
        display: flex;
        align-items: center;
        flex-direction: column;
        font-size: 12px;
        text-wrap: nowrap;
      " id="app-btn">
                <img style="height: 50px" src="./assets/imgs/laragon.png">
                <p style="text-transform: capitalize">Laragon</p>
            </div>

        </div>
    </div>
</div>



<script src="js/circle-progress.min.js" type="module"></script>

<script>

    //window.electron.preferences.quick_icon.app_name
    const isDev = window.electron.isDev;

    const toggleFileShortcut = document.querySelector("#toggle-file-shortcut");
    const dropArea = document.querySelector("#drop-area");
    const btnArea = document.querySelector("#btn-area");
    const appBtn = document.querySelector("#app-btn");
    const holidayText = document.querySelector("#holiday-text");
    const appTitle = document.querySelector("#app-title");
    const quoteBox = document.querySelector("#quoteBox");
    const prevQuote = document.querySelector("#prevQuote");
    const nextQuote = document.querySelector("#nextQuote");
    const quoteWrapper = document.querySelector("#quoteWrapper");
    const nvm = document.querySelector("#nvm");

    const quotesHandler = (quoteIntervalClose = true) => {
        /*let quotes = [
            {
                "quote": "Life isn‚Äôt about getting and having, it‚Äôs about giving and being.", "author": "Kevin Kruse"
            },
            {
                "quote": "Whatever the mind of man can conceive and believe, it can achieve.", "author": "Napoleon Hill"
            },
            {
                "quote": "Strive not to be a success, but rather to be of value.", "author": "Albert Einstein"
            },
            {
                "quote": "Two roads diverged in a wood, and I‚ÄîI took the one less traveled by, And that has made all the difference.",
                "author": "Robert Frost"
            },
            {
                "quote": "I attribute my success to this: I never gave or took any excuse.",
                "author": "Florence Nightingale"
            }
        ];*/

        let quotes = window.electron.quotes;

        const makeArrRandom = () => {

            const randomArr = new Set();
            const quoteLen = quotes.length;
            while (randomArr.size < quoteLen) {
                let randNum = Math.floor(Math.random() * quoteLen);
                randomArr.add(randNum);
            }

            //console.log(Array.from(randomArr));
            return Array.from(randomArr);
        }

        const quoteBoxFn = (randomQuoteIndex) => {
            quoteBox.querySelector('.quoteText').innerHTML = quotes[randomQuoteIndex].quote
            quoteBox.querySelector('.authorOrTitle').innerHTML = quotes[randomQuoteIndex].author
        }

        const randomArr = makeArrRandom();

        quoteBoxFn(randomArr[0] ?? randomArr[0]);

        let quoteSprint = 0;

        const nextQuoteFn = () => {
            quoteSprint++;
            if (quoteSprint > quotes.length - 1) {
                quoteSprint = 0;
            }
            //console.log(quoteSprint)
            quoteBoxFn(randomArr[quoteSprint])
        }

        const prevQuoteFn = () => {
            quoteSprint--;
            if (quoteSprint < 0) {
                quoteSprint = quotes.length-1;
            }
            //console.log(quoteSprint)
            quoteBoxFn(randomArr[quoteSprint])
        }

        nextQuote.addEventListener('click', nextQuoteFn);
        prevQuote.addEventListener('click', prevQuoteFn);


        let quoteInter = setInterval(()=>{
            //quoteText authorOrTitle

            //console.log({quoteSprint}, quotes.length)
            const randomQuote = randomArr[quoteSprint];
            //console.log(randomQuote)

            quoteBoxFn(randomQuote);

            quoteSprint++;

            if (quoteSprint === quotes.length) {
                quoteSprint = 0;
                console.log('--')
            }

        }, 10000);

        if (quoteIntervalClose) {
            clearInterval(quoteInter);
        }

        let initDone = true;

        return initDone;
    }

    //window.electron.preferences.plugin.selectPlugin
    let initDone = false;
    if (window.electron.preferences.plugin.selectPlugin === 'quote') {
        quoteWrapper.style.display = 'block';
        initDone = quotesHandler(false);
    } else {
        initDone = false;
        nvm.style.display = 'block';
    }

    //quote.innerHTML = 'ddddddddddd'

    const appInitOrUpdate = (updatedPreferences = null) => {
        let preferences = window.electron.preferences;
        if (updatedPreferences !== null) {
            preferences = updatedPreferences;
        }
        iconList(preferences.quick_icon.app_name);
        appTitle.innerHTML = preferences.general.title;
    }

    document.addEventListener("prefUpdated", (e) => {
        let preferences = e.detail.preferences;
        appInitOrUpdate(preferences);

        if (preferences.plugin.selectPlugin === 'quote') {
            quoteWrapper.style.display = 'block';
            nvm.style.display = 'none';

            initDone || quotesHandler(false);
        } else {
            nvm.style.display = 'block';
            quoteWrapper.style.display = 'none';
            quotesHandler();
        }
    });



    toggleFileShortcut.addEventListener("click", ()=>{
        //console.log(dropArea.style.display)
        if (dropArea.style.display === 'block') {
            toggleFileShortcut.style.background = 'radial-gradient(white, green 50%)'
            dropArea.style.display = 'none';
            btnArea.style.display = 'flex';
        } else {
            toggleFileShortcut.style.background = 'radial-gradient(white, green)'
            dropArea.style.display = 'block';
            btnArea.style.display = 'none';
        }
    })


    dropArea.addEventListener('dragover', function (e) {
        e.preventDefault();
        //console.log(e)
    });

    dropArea.addEventListener('drop', function (e) {
        e.preventDefault();
        fileHandling(e.dataTransfer.files[0].path)
        //console.dir(e.dataTransfer.files[0], this)
    });



    const iconList = (app_names) => {

        btnArea.innerHTML = '';
        btnArea.style.display = 'flex';


        if (app_names.length) {
            dropArea.style.display = 'none';
            toggleFileShortcut.style.display = 'block';
        } else {
            dropArea.style.display = 'block';
            toggleFileShortcut.style.display = 'none';
        }

        app_names.forEach((elm, index) => {
            let filename = elm.replace(/^.*[\\/]/, '');
            const cloneAppBtn = appBtn.cloneNode(true);
            cloneAppBtn.style.display = 'flex'
            if (isDev) {
                cloneAppBtn.querySelector('img').src = `assets/imgs/icons/${filename}.png`;
            } else {
                cloneAppBtn.querySelector('img').src = `./../../../icons/${filename}.png`;
            }
            let filenameSplit = filename.split('.');
            let fileExt = filenameSplit.pop();
            let filenameSplitJoin = filenameSplit.join(".");
            let filenameFWord = filenameSplitJoin.length >= 10 ? filenameSplitJoin.substring(0, 7) + '...' + fileExt : filenameSplitJoin + '.' + fileExt;
            filenameFWord = filenameFWord.replace(/[-_]/g, " ")
            cloneAppBtn.querySelector('p').innerText = filenameFWord;
            cloneAppBtn.id = `file-${index}`
            btnArea.appendChild(cloneAppBtn);
        });

        app_names.forEach((elm, index)=>{
            document.getElementById("file-"+index).addEventListener('click', ()=>{
                window.electron.iconRun(elm);
            });
        });

    }


    const showHoliday = () => {
        let date_string = window.electron.preferences.holiday.date_string
        let dates = date_string.split("|");

        const d = new Date();
        let currMonth = String(d.getMonth() + 1);
        let currDate = ("0"+d.getDate()).slice(-2);

        /*currMonth = '5';
        currDate = '22';*/

        let currMonthFilter = dates.filter(elm=>{
            let elmSplit = elm.split(",");
            let cal_date = elmSplit[0].split("-");
            return Number(cal_date[1] + cal_date[0]) >= Number(currMonth + currDate);
        });

        let nextHolidayText = currMonthFilter[0];
        let commaPos = nextHolidayText.indexOf(",");
        let cal_date = nextHolidayText.substring(0, commaPos).split('-');
        let calMonth = cal_date[1];
        let calExactDate = cal_date[0];
        let today = Number(calMonth + calExactDate) === Number(currMonth + currDate);
        let spans = holidayText.querySelectorAll('span');
        if (!!today) {
            spans[0].style.color = 'red';
            spans[0].style.fontWeight = 'bold';
            spans[0].innerHTML = 'Today Holiday: ';
            spans[1].innerHTML = nextHolidayText;
        } else {
            spans[0].innerHTML = 'Next Holiday: ';
            spans[1].innerHTML = nextHolidayText;
        }
    }

    appInitOrUpdate();

    showHoliday();

</script>

<script src="./js/btn.js"></script>
</body>
</html>
